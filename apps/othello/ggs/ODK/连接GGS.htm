<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<!-- saved from url=(0040)http://www.soongsky.com/computer/odk.php -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="shortcut icon" href="http://www.soongsky.com/favicon.ico">

<meta name="Description" content="使用ODK连接GGS">
<meta name="Keywords" content="电脑黑白棋, 算法, AI, 连接GGS, ODK">
<title>连接GGS - 电脑黑白棋 - 阿宋黑白棋天地</title>
<link href="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/base.css" rel="stylesheet" type="text/css">
<link href="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/cn.css" rel="stylesheet" type="text/css">

<script type="text/javascript"><!--
	var java = "../java/";
	var image = "../img/";
//-->
</script>
<script type="text/javascript" src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/pack-utf8.js"></script><script type="text/javascript" src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/Detect"></script><script type="text/javascript" src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/Translate"></script><script type="text/javascript" src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/Translate(1)"></script><script type="text/javascript" src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/Translate(2)"></script><script type="text/javascript" src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/Translate(3)"></script><script type="text/javascript" src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/Detect(1)"></script><script type="text/javascript" src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/Translate(4)"></script><script type="text/javascript" src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/Translate(5)"></script></head>
<body>
<div id="header">
	<div class="float_right right">
		<a href="http://www.soongsky.com/en/">English</a><br>
<form action="http://www.google.com/custom" method="get" target="_blank">
	<div>
	<input type="text" name="q" size="15" maxlength="255" value="黑白棋资讯" id="sbi">
	<input type="submit" name="sa" value="搜索" id="sbb">
	<input type="hidden" name="client" value="pub-7186532985806135">
	<input type="hidden" name="forid" value="1">
	<input type="hidden" name="ie" value="UTF-8">
	<input type="hidden" name="oe" value="UTF-8">
	<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:1">
	<input type="hidden" name="hl" value="zh-CN">
	</div>
</form>
	</div>
	<a href="http://www.soongsky.com/"><img src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/logo.gif" alt="阿宋黑白棋天地 - Soong&#39;s Othello Sky" width="468" height="60"></a>
	<div class="navbar">
		<dl>
			<dt class="float_right"><a href="http://www.othello.cn/bbs/" target="_blank">联盟论坛</a><span class="new">新</span></dt>
			<dt><a href="http://www.soongsky.com/">首页</a></dt>
			<!-- <dt><a href="../basic/">基础知识</a><span class="new">新</span></dt> -->
			<dt><a href="http://www.soongsky.com/strategy/">基本策略</a></dt>
			<dt><a href="http://www.soongsky.com/tournament/">赛事</a></dt>
			<dt><a href="http://www.soongsky.com/database/">棋局鉴赏</a></dt>
			<dt><a href="http://www.soongsky.com/computer/">电脑黑白棋</a></dt>
			<dt><a href="http://www.soongsky.com/link/">链接</a></dt>
			<dt><a href="http://www.soongsky.com/download/">下载</a></dt>
			<!-- <dt><a href="http://forum.soongsky.com/">论坛</a></dt> -->
		</dl>
	</div>
</div>
<div id="page">
<div id="adbar"><script type="text/javascript"><!--
	google_ad_client = "pub-7186532985806135";
	/* 摩天大楼文字广告, 120x600, 创建于 09-3-12 */
	google_ad_slot = "7685356300";
	google_ad_width = 120;
	google_ad_height = 600;
	//-->
</script>
<script type="text/javascript" src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/show_ads.js"></script><ins style="display:inline-table;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:120px"><ins id="aswift_0_anchor" style="display:block;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:120px"><iframe allowtransparency="true" frameborder="0" height="600" hspace="0" marginwidth="0" marginheight="0" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){i+=&#39;.call&#39;;setTimeout(h,0)}else if(h.match){i+=&#39;.nav&#39;;w.location.replace(h)}s.log&amp;&amp;s.log.push(i)}" scrolling="no" vspace="0" width="120" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;"></iframe></ins></ins>
</div>
<div id="sidebar">
<dl>
	<dt>电脑黑白棋</dt>
	<dd><a href="http://www.soongsky.com/computer/index.php">前言</a></dd>
	<dd><a href="http://www.soongsky.com/computer/search.php">基本搜索</a></dd>
	<dd><a href="http://www.soongsky.com/computer/alpha_beta.php">α-β剪枝算法</a></dd>
	<dd><a href="http://www.soongsky.com/computer/pvs.php">主要变化搜索</a></dd>
	<dd><a href="http://www.soongsky.com/computer/hashtable.php">散列表</a></dd>
	<dd><a href="http://www.soongsky.com/computer/zobrist.php">Zobrist散列</a></dd>
	<dd><a href="http://www.soongsky.com/computer/mtdf.php">MTD(f)算法</a></dd>
	<dd><a href="http://www.soongsky.com/computer/deepening.php">迭代加深搜索</a></dd>
	<dd>棋步排序</dd>
	<dd>估值函数</dd>
	<dd>概率剪枝</dd>
	<dd>后台思考</dd>
	<dd>尾盘解算</dd>
	<dd>开局库</dd>
	<dd>模式自动运算</dd>
	<dd>棋盘表示法</dd>
	<dd><a href="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/连接GGS - 电脑黑白棋 - 阿宋黑白棋天地.htm">连接GGS</a></dd>
	<dd>&nbsp;</dd>
</dl>
</div>
<div id="content">
<h1>连接GGS</h1>
<p>当你编写完自己的黑白棋程序后，是不是想和其他程序比比棋力？GGS（Generic Game Server）服务器为你提供这样的对战平台。GGS不仅是人类棋手下棋的地方，还有不少世界顶级的黑白棋程序也常年挂在上面，如：Logistello、Saio。你一样可以把自己的程序自动连接到GGS上，与其他棋手或程序进行对战。</p>
<h3>注册GGS用户</h3>
<p>为了使你的程序能登录到GGS服务器，你必须为它注册一个GGS用户。先下载一个GGS的客户端程序，如：<a href="http://www.soongsky.com/download/other.php#lion">Lion</a>或<a href="http://www.soongsky.com/download/other.php#mimosa">Mimosa</a>，下面以Lion汉化版为例。第一次运行Lion时，当出现登录框后，先点“取消”。再点击菜单： GGS -&gt; 服务器设定，将服务器名称改为：skatgame.net（如果服务器地址有变动，请关注<a href="http://www.skatgame.net/mburo/ggs/" target="_blank">GGS主页</a>的相关公告）。然后再点击菜单 ：GGS -&gt; 连接GGS，出现登录框后，填入你喜欢的用户名及密码。登录成功后，还需要找管理员（在线列表窗口上的注册类型栏显示为“a”的人）注册为注册用户。</p>
<p>一般来说，你还需要为自己另外注册一个用户，供你自己登录到GGS服务器用，以便能监视和指挥程序的运行。</p>
<h3>ODK开发包</h3>
<p><a href="http://othellogateway.com/ntest/" target="_blank" class="name">Chris Welty</a>提供了一个黑白棋开发包ODK（Othello Development Kit），它包含了连接GGS服务器所需的完整源代码。你只要稍加修改，就可以很方便地把自己的程序连接到GGS。</p>
<p>先下载<a href="http://www.soongsky.com/download/other.php#lion">ODK源程序</a>，并把它解压到一个目录内。再进行相关配置：</p>
<p>1、修改main.cpp</p>
<pre class="code">int main() {
	……
	if (err = gs.Connect("external.nj.nec.com",5000)) {
</pre>
<p>将上面的external.nj.nec.com改为当前的GGS服务器，如：skatgame.net。</p>
<pre class="code">int main() {
	……
	if (err = gs.Login("greedy", "password")) {
</pre>
<p>将上面的greedy和password改为你所注册的程序用户名和密码。</p>
<p>2、修改ODKStream.cpp</p>
<pre class="code">void CODKStream::HandleGGSTell(const CMsgGGSTell* pmsg) {
	……
	if (pmsg-&gt;sFrom == "n2") {
</pre>
<p>将上面的n2改为你自己的用户名，这样程序就能接受你所发的指令。</p>
<p>然后编译源程序，可使用Borland C++对所有.cpp文件进行编译。如果使用VC++的话，源程序有几个地方可能需要略做修改（主要是涉及const_iterator），同时还必须链接ws2_32.lib（在项目属性中的附加依赖项加上ws2_32.lib，或者在sockbuf.h文件中加上#pragma comment(lib, "ws2_32.lib")）。</p>
<p>运行程序后，程序应能自动连接到GGS。然后你用自己的用户名登录上GGS，就可以在“在线列表”窗口上看到程序用户名。现在你可以试着给程序发指令，点击“在线列表”上的程序用户名（或者在程序用户名上点击右键菜单“与对方交谈”），然后在弹出的“.chat”窗口内输入：ta 8 ant。这样，程序就会去邀请ant下一盘8×8的黑白棋。下完棋后，在“.chat”窗口内输入：quit，程序就退出GGS。</p>
<h3>连接自己的程序</h3>
<p>现在你可以把自己的程序加入ODK，其核心接口部分是GetMove.cpp的GetMove()函数。</p>
<pre class="code">void GetMove(const COsGame&amp; game, COsMoveListItem&amp; mli) {</pre>
<p>当轮到你下棋时，GetMove()函数负责从你这里取得一步棋。你应对GetMove()函数做相应修改，使它与你自己的程序对接，并把程序计算出的结果放在mli内。当GetMove()函数返回后，ODK就会将这步棋回传到GGS去下。</p>
<p>game.pos包含了当前局面的情况，其中game.pos.board.sBoard描述了盘面各个位置的棋子分布。由于sBoard是采用包含边界填充子的扩展棋盘表示法，除非你十分清楚这种扩展棋盘的结构，否则一般应使用game.pos.board.GetText()或game.pos.board.Piece()函数取得盘面情况。game.pos.board.fBlackMove表示当前是否轮到黑棋下，而game.pos.cks[game.pos.board.fBlackMove].tCurrent是你所剩余的时间。</p>
<p>mli.mv就是你所要下的棋步，其中mli.mv.fPass表示是否弃权，如果这步棋弃权，设mli.mv.fPass = true；否则设mli.mv.fPass = false，mli.mv.row及mli.mv.col设为下棋点的行、列位置（0-基）， 如(row, col) = (0, 1)就表示从左上角起第1行第2列的位置。mli.dEval为c这步棋的估值，这是可选的项。</p>
<h3>实现更多的功能</h3>
<p>在ODKStream.cpp的CODKStream类中，包含一些处理各种报文的HandleXXX()函数。通过修改这些函数，你可以实现更多的功能。而CODKStream类又是继承于ggsstream.cpp的ggsstream类，它实际上只重载了其中的一部分HandleXXX()函数，你完全可以根据自己的需要，在CODKStream类中重载更多的函数。</p>
<p>1、自动接受对局</p>
<p>当你的程序连线GGS后，你一定希望它能自动接受其他玩家的挑战。但是你的程序可能只支持特定类型的对局，因此对于程序支持的对局请求，程序就自动接受；而对于那些不支持的类型，程序应给予拒绝。CODKStream::HandleOsRequestDelta()就是处理对局请求报文的函数，它可根据所请求对局的类型来决定是否应战。先将该函数去注释，再通过配置if语句中相应的pmsg-&gt;RequireXXX()函数，来实现自动接受请求的功能。CMsgOsRequestDelta类提供了各种RequireXXX()函数，用于判别不同的对局类型。例如：</p>
<pre class="code">equireBoardSize(int)  用于判别棋盘大小
RequireKomi()              用于判别是否贴目
RequireAnti()              用于判别是否下反棋
RequireRand()              用于判别是否下随机开局棋
RequireSynch()             用于判别是否下同步棋
RequireRated()             用于判别是否为计分棋
RequireMaxOpponentClock()  用于判别判别对方最大时间
RequireMinMyClock()        用于判别己方最小时间</pre>
<p>2、悔棋功能</p>
<p>如果你想允许对方悔棋（让程序显得更友好些），那么你可以在CODKStream类中重载HandleOsUndoRequest()函数。当对方发悔棋请求时，程序自动进行回应。值得注意的是，当对方想要悔棋时，他需要撤消前面的两步棋：你所下的一步棋和他自己所下的一步棋。因此，当你回应对方的悔棋请求后，还应再发一个悔棋请求。这里给出一个简单的例子：</p>
<pre class="code">void CODKStream::HandleOsUndoRequest (const CMsgOsUndoRequest* pmsg){
	//如果是对方发的请求
	if (pmsg-&gt;sLogin != GetLogin()){
		//回应撤消己方的一步棋
		(*this) &lt;&lt; "ts undo " &lt;&lt; pmsg-&gt;idg &lt;&lt; "\n";
		flush();
		//请求撤消对方的一步棋
		(*this) &lt;&lt; "ts undo " &lt;&lt; pmsg-&gt;idg &lt;&lt; "\n";
		flush();
		//留点时间让对方响应，以免立刻进入自动下棋
		_sleep(5);
	}
}
</pre>
<p>3、盘后处理</p>
<p>如果你想在下完一盘棋后做点什么，比如对刚下完的这盘棋进行学习，那么你可以在CODKStream类中重载HandleOsGameOver()函数，就象下面这样：</p>
<pre class="code">void CODKStream::HandleOsGameOver(const CMsgOsMatchDelta* pmsg,const string&amp; idg) {
	if (pmsg-&gt;match.IsPlaying(GetLogin())) {
		LearnGame(idToGame[idg]);
	}
	BaseOsGameOver(pmsg, idg);
}</pre>
<p>这里LearnGame()是你自己设计的对局学习函数。</p>
<p>4、增添资料信息</p>
<p>你可以在用户信息的info一栏里增添一些关于程序的说明，就象这样：</p>
<pre class="code">void CODKStream::HandleGGSLogin() {
	BaseGGSLogin();
	(*this) &lt;&lt; "mso\n";
	flush();
	(*this) &lt;&lt; "info 4-ply Robot\rFrom China(中国)\n";
	flush();
}</pre>
<p>更多关于GGS的内容，请查阅《<a href="http://www.soongsky.com/computer/ggs_howto.php">GGS指南</a>》或<a href="http://www.skatgame.net/mburo/ggs/" target="_blank">GGS主页</a>的相关资讯。</p>
<div class="back_to_top"><a href="http://www.soongsky.com/computer/odk.php#">页首</a></div>
</div>
</div>
<div id="footer" class="navbar">
	<dl>
		<dt class="hosting">空间由<a href="http://www.e9china.net/?fromuid=792" target="_blank">亿家互连</a>提供</dt>
		<dt>©2005-2012 <a href="http://www.soongsky.com/">阿 宋</a> 版权所有</dt>
		<dt><a href="mailto:soong@soongsky.com">联系我们</a></dt>
	</dl>
</div>


<div id="cs_someyi" style="position: absolute; left: 1303px; text-align: left; font-size: 13px; font-family: &#39;Microsoft YaHei&#39;, 寰蒋闆呴粦; z-index: 10000; line-height: 1.5; color: rgb(255, 255, 255); overflow-x: visible; overflow-y: visible; top: 30px; "><div id="cs_someyi_icon" style="overflow:visible;position:absolute;text-align:center;cursor:pointer;width:45px;height:45px;background:transparent url(http://yi.comsome.com/images/icon.png) repeat scroll 0 0;right:0;top:4px;"><div id="cs_someyi_load" style="overflow-x: visible; overflow-y: visible; margin-top: 30px; display: none; "><img src="./连接GGS - 电脑黑白棋 - 阿宋黑白棋天地_files/load.gif"></div><object id="cs_someyi_ob" name="cs_someyi_s" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="1" height="1"><param name="allowScriptAccess" value="always"><param name="movie" value="http://yi.comsome.com/images/sub_write.swf"><param name="quality" value="high"><param name="wmode" value="window"><embed id="cs_someyi_em" name="cs_someyi_s" src="http://yi.comsome.com/images/sub_write.swf" quality="high" width="1" height="1" allowscriptaccess="always" wmode="window" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"></object></div><div id="cs_someyi_wallon" style="overflow-x: visible; overflow-y: visible; right: 50px; margin-top: 0px; margin-right: 20px; margin-bottom: 0px; margin-left: 20px; position: absolute; top: 0px; width: 300px; display: none; "><div style="overflow:visible;"><span style="position:absolute;display:block;background:transparent url(http://yi.comsome.com/images/wallon1.png) no-repeat 0 0;height:100%;width:100%;"></span><span style="position:absolute;display:block;background:transparent url(http://yi.comsome.com/images/wallon1.png) no-repeat 100% 0;height:35px;width:20px;right:-20px;"></span><span style="position:absolute;display:block;background:transparent url(http://yi.comsome.com/images/wallon1.png) no-repeat 100% 100%;height:100%;width:100%;right:-20px;bottom:-35px;"></span><span style="position:absolute;display:block;background:transparent url(http://yi.comsome.com/images/wallon1.png) no-repeat 0 100%;height:35px;width:20px;bottom:-35px;left:0"></span></div><div style="position:relative;z-index:0;overflow:visible;"><div id="cs_someyi_content" style="overflow:auto;max-height:490px;margin: 5px;padding:5px;margin-bottom:0;padding-bottom:0;background-color:#0b5891;">Connect GGS when after you have written your own black and white chess program, is not want to misery chess and other programs? GGS (Generic Game Server) Server provides you with the battle platform. GGS is not only the place where humans play chess players, black and white for many of the world's top chess programs are also perennial hanging on it, such as: Logistello and the Saio.
You can automatically connect to their program on the GGS, battle with other players or programs. GGS registered users in order for your program to log on to the GGS servers, you must register a GGS for it users. First download a GGS client programs, such as Mimosa or Lion, Lion of the Chinese version below as an example. When you first run the Lion, when the login box, and "Cancel". Then click on the menu: GGS-&gt; server settings, change the server name to: skatgame.NET (if the server address changes, keep an eye on GGS related announcements on the homepage). Then click on the menu: GGS GGS-&gt; connection, after the login box that appears, fill in the username and password you like.
After a successful login, need to find administrator (online registration type bar on the window is displayed as "a" person) for registration as a registered user.
In General, you need to register a user for yourself, for your own login to GGS server, to command and monitor the program running. ODK SDK Chris Welty ODK provides a black and white chess development package (Othello Development Kit), which contains the complete source code required to connect GGS server.
You have only a slightly modified, you can easily connect their GGS. First download the ODK source programs, and extract it to a directory. Configuration: 1, modify the main.cpp int main () {sth if (err=GS.
Connect ("external.NJ.NEC.com", 5,000)) {external.NJ.NEC.com to the previous current GGS server, such as: skatgame.NET. int main() {
	……
	if (err = gs.
Login ("greedy", "password")) {the greedy and password above to your registered user name and password.
2, modify the ODKStream.cpp void CODKStream::HandleGGSTell (const CMsgGGSTell*pmsg) {sth if (pmsg-&gt;sFrom== "N2") {N2 above to your own user name, so that the program can accept instructions issued by you. And then compile the source program, all using the Borland c. compiling cpp file. If you are using VC, source program, there are a few places you may need slight modifications (mainly involving const_iterator), it must also link WS2_32.lib (additional dependencies the project properties with WS2_32.lib, or added to the sockbuf.h file<br><br></div></div><div style="overflow:visible;position:absolute;bottom:-30px;height:30px;text-align:center;width:100%;font-size:12px;line-height:30px;color:#999;padding:0 10px;"><span id="cs_someyi_time">0</span>&nbsp;&nbsp;&nbsp;<span id="cs_someyi_pause" style="margin-top:-2px;vertical-align:middle;width:17px;height:16px;background:transparent url(http://yi.comsome.com/images/icon.png) no-repeat -17px -64px;line-height:0;font-size:0;display:inline-block;cursor:pointer;" title="control"></span>&nbsp;&nbsp;<span id="cs_someyi_more" style="margin-top: -2px; vertical-align: middle; width: 17px; height: 16px; background-image: url(http://yi.comsome.com/images/icon.png); background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; line-height: 0; font-size: 0px; display: inline-block; cursor: pointer; background-position: -53px -64px; background-repeat: no-repeat no-repeat; " title="translate more"></span>&nbsp;&nbsp;<span id="cs_someyi_list" style="margin-top: -2px; vertical-align: middle; width: 17px; height: 16px; background-image: url(http://yi.comsome.com/images/icon.png); background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; line-height: 0; font-size: 0px; display: inline-block; cursor: pointer; background-position: -72px -64px; background-repeat: no-repeat no-repeat; " title="ikeepu.com"></span>&nbsp;&nbsp;<span id="cs_someyi_close" style="margin-top: -2px; vertical-align: middle; width: 17px; height: 16px; background-image: url(http://yi.comsome.com/images/icon.png); background-attachment: initial; background-origin: initial; background-clip: initial; background-color: transparent; line-height: 0; font-size: 0px; display: inline-block; cursor: pointer; background-position: -34px -64px; background-repeat: no-repeat no-repeat; " onmouseover="this.style.backgroundPosition=&#39;-34px -48px&#39;" onmouseout="this.style.backgroundPosition=&#39;-34px -64px&#39;" title="close"></span></div></div></div></body></html>